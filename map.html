<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>88</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0-12/css/all.min.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin=""/>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/MarkerCluster.css"></link> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/MarkerCluster.Default.css"></link> 
    <style>
      #map {
    height: 100%; width: 100%;
    }
    html,body{
    width: 100%;
    height: 100%;
   }
    </style>
</head>
<body>
  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
  integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
  crossorigin=""></script>
  
  <div id="map"></div>

  <script>
var myposition = L.layerGroup();
var layer0 = L.layerGroup();
var layer1 = L.layerGroup();
var layer2 = L.layerGroup();
var layer3 = L.layerGroup();


var style1 = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
	maxZoom: 19,
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
});
var map = L.map('map', {
		center: [23.974094, 120.937539],
		zoom: 15,
    zoomDelta: 0.25,
    zoomSnap: 0.25,
		layers: [style1, layer0]
	});
map.locate({
  //setView: true, // 是否讓地圖跟著移動中心點
  watch: true, // 是否要一直監測使用者位置
  maxZoom: 18, // 最大的縮放值
  enableHighAccuracy: true, // 是否要高精準度的抓位置
  timeout: 10000 // 觸發locationerror事件之前等待的毫秒數
});

var marker1 = L.marker([23.967002, 120.946504]).bindPopup("<b>烏牛欄橋</b>").addTo(layer1).addTo(layer0).addTo(myposition);//烏牛欄橋*
marker1.on('click', function(e) {
  console.log(e);
  map.flyTo([23.967002, 120.946504]);
})
var marker2 = L.marker([23.966369, 120.946472]).bindPopup("<b>烏牛欄戰役紀念碑</b>").addTo(layer1).addTo(layer0).addTo(myposition);//烏牛欄戰役紀念碑*
marker2.on('click', function(e) {
  console.log(e);
  map.flyTo([23.966369, 120.946472])
})
var marker3 = L.marker([23.965097, 120.945654]).bindPopup("<b>木生昆蟲博物館</b>").addTo(layer1).addTo(layer0).addTo(myposition);//木生昆蟲博物館*
marker3.on('click', function(e) {
  console.log(e);
  map.flyTo([23.965097, 120.945654])
})
var marker4 = L.marker([23.96652758440399, 120.94474061136678]).bindPopup("<b>牛耳石雕公園</b>").addTo(layer1).addTo(layer0).addTo(myposition);//牛耳石雕公園*
marker4.on('click', function(e) {
  console.log(e);
  map.flyTo([23.96652758440399, 120.94474061136678])
})
var marker5 = L.marker([23.973901, 120.933402]).bindPopup("<b>南村里義民祠</b>").addTo(layer1).addTo(layer0).addTo(myposition);//南村里義民祠*
marker5.on('click', function(e) {
  console.log(e);
  map.flyTo([23.973901, 120.933402])

})
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var marker6 = L.marker([23.967798, 120.946105]).bindPopup("<b>醒靈寺</b>").addTo(layer2).addTo(layer0).addTo(myposition);//醒靈寺*
marker6.on('click', function(e) {
  console.log(e);
  map.flyTo([23.967798, 120.946105])
})
var marker7 = L.marker([23.969374174975307, 120.9451624685048]).bindPopup("<b>大馬璘遺址公園</b>").addTo(layer2).addTo(layer0).addTo(myposition);//大馬璘遺址公園*
marker7.on('click', function(e) {
  console.log(e);
  map.flyTo([23.969374174975307, 120.9451624685048])
})
var marker8 = L.marker([23.970352, 120.946581]).bindPopup("<b>埔里基督教醫院</b>").addTo(layer2).addTo(layer0).addTo(myposition);//埔里基督教醫院*
marker8.on('click', function(e) {
  console.log(e);
  map.flyTo([23.970352, 120.946581])
})
var marker9 = L.marker([23.972127, 120.944656]).bindPopup("<b>暨大附中</b>").addTo(layer2).addTo(layer0).addTo(myposition);//暨大附中*
marker9.on('click', function(e) {
  console.log(e);
  map.flyTo([23.972127, 120.944656])
})
var marker10 = L.marker([23.971597657598792, 120.94746479826168]).bindPopup("<b>埔基長照中心</b>").addTo(layer2).addTo(layer0).addTo(myposition);//埔基長照中心*
marker10.on('click', function(e) {
  console.log(e);
  map.flyTo([23.971597657598792, 120.94746479826168])
})
var marker11 = L.marker([23.973616, 120.943293]).bindPopup("<b>愛蘭國小</b>").addTo(layer2).addTo(layer0).addTo(myposition);//愛蘭國小*
marker11.on('click', function(e) {
  console.log(e);
  map.flyTo([23.973616, 120.943293])
})
var marker12 = L.marker([23.970836154614314, 120.94372439734076]).bindPopup("<b>梅村社造土角胖</b>").addTo(layer2).addTo(layer0).addTo(myposition);//梅村社造土角胖*
marker12.on('click', function(e) {
  console.log(e);
  map.flyTo([23.970836154614314, 120.94372439734076])
})
var marker13 = L.marker([23.974180567557895, 120.94073987457362]).bindPopup("<b>烏牛欄教會</b>").addTo(layer2).addTo(layer0).addTo(myposition);//烏牛欄教會*
marker13.on('click', function(e) {
  console.log(e);
  map.flyTo([23.974180567557895, 120.94073987457362])
})
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var marker14 = L.marker([23.975528, 120.938659]).bindPopup("<b>廣興紙寮</b>").addTo(layer3).addTo(layer0).addTo(myposition);//廣興紙寮*
marker14.on('click', function(e) {
  console.log(e);
  map.flyTo([23.975528, 120.938659])
})
var marker15 = L.marker([23.97650035524517, 120.93900908199737]).bindPopup("<b>西鎮堂</b>").addTo(layer3).addTo(layer0).addTo(myposition);//西鎮堂*
marker15.on('click', function(e) {
  console.log(e);
  map.flyTo([23.97650035524517, 120.93900908199737])
})
var marker16 = L.marker([23.97616651855373, 120.93902558384855]).bindPopup("<b>烏牛欄手作巧克力花園</b>").addTo(layer3).addTo(layer0).addTo(myposition);//烏牛欄手作巧克力花園*
marker16.on('click', function(e) {
  console.log(e);
  map.flyTo([23.97616651855373, 120.93902558384855])
})
var marker17 = L.marker([23.976358155906258, 120.93907550531344]).bindPopup("<b>黃望家古厝</b>").addTo(layer3).addTo(layer0).addTo(myposition);//黃望家古厝*
marker17.on('click', function(e) {
  console.log(e);
  map.flyTo([23.976358155906258, 120.93907550531344])
})
var marker18 = L.marker([23.976006934266675, 120.9378292108332]).bindPopup("<b>紹興酒泉&洗衣亭</b>").addTo(layer3).addTo(layer0).addTo(myposition);//紹興酒泉&洗衣亭*
marker18.on('click', function(e) {
  console.log(e);
  map.flyTo([23.976006934266675, 120.9378292108332])
})
var marker19 = L.marker([23.97187868923758, 120.92585640580386]).bindPopup("<b>平埔墓碑</b>").addTo(layer3).addTo(layer0).addTo(myposition);//平埔墓碑*
marker19.on('click', function(e) {
  console.log(e);
  map.flyTo([23.97187868923758, 120.92585640580386])
})
var marker20 = L.marker([23.976659051894384, 120.94098648199723]).bindPopup("<b>日南天后宮</b>").addTo(layer3).addTo(layer0).addTo(myposition);//日南天后宮*
marker20.on('click', function(e) {
  console.log(e);
  map.flyTo([23.976659051894384, 120.94098648199723])
})
var marker21 = L.marker([23.9820125322742, 120.9316252838487]).bindPopup("<b>天雷宮</b>").addTo(layer3).addTo(layer0).addTo(myposition);//天雷宮*
marker21.on('click', function(e) {
  console.log(e);
  map.flyTo([23.9820125322742, 120.9316252838487])
})
var marker22 = L.marker([23.977627, 120.93354], ).bindPopup("<b>船尾—地質露頭</b><img src='./船山照片/愛蘭戰役紀念碑.jpg'" ).addTo(layer3).addTo(layer0).addTo(myposition);//船尾—地質露頭
marker22.on('click', function(e) {
  console.log(e);
  map.flyTo([23.977627, 120.93354])
})
function onLocationFound(e) {
		var radius = e.accuracy / 2;

		var my = L.marker(e.latlng).bindPopup("您目前的位置").addTo(myposition).addTo(layer0);

		L.circle(e.latlng, radius).addTo(myposition).addTo(layer0);
    var latlngs =[[23.977627, 120.93354],e.latlng];
    L.polyline(latlngs, {color: 'red'}).addTo(myposition);
    my.on('click', function(e) {
      console.log(e);
      map.flyTo(e.latlng);
    })
}
map.on('locationfound', onLocationFound);

function onLocationError(e) {
	console.log(e);
  window.alert('無法判斷您的所在位置，故無法顯示目前位置。');
  map.flyTo([23.974094, 120.937539]);
}




map.on('locationerror', onLocationError);

//map.locate({setView: true, maxZoom: 18});


  var overlayMaps = {
    "目前位置": myposition,
    "船山22景點": layer0,
    "南村區": layer1,
    "大馬璘與烏牛欄區": layer2,
    "阿里史區": layer3
  };
  
  L.control.layers(overlayMaps).addTo(map);


//點擊可得座標
var popup = L.popup();
function onMapClick(e) {
    popup
        .setLatLng(e.latlng)
        .setContent("目前座標為：" + e.latlng.toString())
        .openOn(map);
}

map.on('click', onMapClick);
  </script>
  
</body>
</html>
